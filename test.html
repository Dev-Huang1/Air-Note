<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Notes | Your private notes</title>
    <link rel="icon" href="/assets/images/Easy-Notes-Logo.png" type="image/x-icon">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8;
        }

        #notes-list {
            padding: 20px;
        }

        #notes-list h1 {
            text-align: center;
        }

        #notes-list ul {
            list-style-type: none;
            padding: 0;
        }

        #notes-list li {
            background: white;
            margin: 10px 0;
            padding: 10px;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        #add-note-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #0066ff;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 3px 8px #0066ff;
        }

        #note-editor {
            padding: 20px;
        }

        #note-title {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 12px;
            font-size: 16px;
            box-sizing: border-box;
        }

        #note-content {
            width: 100%;
            height: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 12px;
            font-size: 16px;
            box-sizing: border-box;
        }

        #editor-toolbar {
            margin-top: 10px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
        }

        #editor-toolbar > div,
        #editor-toolbar > button {
            flex: 1;
            margin: 5px;
        }

        #editor-toolbar input[type="file"] {
            display: none;
        }

        #save-note-btn,
        #back-to-list-main,
        #editor-toolbar button {
            background-color: #0066ff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px 0;
        }

        #note-category {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 16px;
            margin-left: 5px;
        }

        @media (max-width: 768px) {
            #editor-toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            #editor-toolbar > div,
            #editor-toolbar > button {
                flex: none;
                margin: 10px 0;
                width: 100%;
             }

             #save-note-btn,
             #back-to-list-main,
             #editor-toolbar button {
                 padding: 10px;
                 font-size: 14px;
                 width: 100%;
             }

             #note-category {
                 width: 100%;
                 margin-left: 0;
             }
        }

        .note-actions {
            margin-top: 10px;
        }

        .note-actions button {
            margin-right: 5px;
            padding: 10px 20px;
            cursor: pointer;
            background-color: #0066ff;
            color: white;
            border: none;
            border-radius: 20px;
        }

        #delete-confirm {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: none;
            width: 30%;
        }

        @media (max-width: 768px) {
            #delete-confirm {
                width: 65%;
            }
        }

        #delete-confirm p {
            margin-bottom: 20px;
        }

        #delete-confirm button {
            background-color: #0066ff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            margin-right: 10px;
        }

        #delete-confirm button.cancel {
            background-color: #999;
        }

        #search-bar {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 12px;
            font-size: 16px;
            box-sizing: border-box;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .category-tag {
            padding: 2px 8px;
            margin-right: 5px;
            border-radius: 4px;
            font-size: 12px;
            color: white; 
        }

        .category-work {
            background-color: #0066ff; /* Blue for Work */
        }

        .category-personal {
            background-color: #66cc66; /* Light green for Personal */
        }

        .category-learn {
            background-color: #ffd700; /* Light yellow for Learn */
        }

        .note-preview {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        #note-detail {
            display: none;
            padding: 20px;
            background-color: white;
            height: 100%;
            position: relative; /* 添加这个属性来定位返回链接 */
        }

        #note-detail h2 {
            margin-top: 0;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        .image-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .image-preview {
            position: relative;
            display: inline-block;
        }

        .image-preview img {
            max-width: 150px;
            height: auto;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .delete-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: red;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .draggable {
            cursor: move;
        }

        #loading-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .from-tech-art-container {
            position: absolute;
            bottom: 50px;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        .from-tech-art {
            width: 100px;
        }

        #back-to-list {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #0066ff;
            cursor: pointer;
            font-size: 16px;
            text-decoration: underline;
            background: none;
            border: none;
            padding: 0;
        }
    </style>
</head>
<body>
    <div id="loading-page" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: flex; justify-content: center; align-items: center; z-index: 9999;">
        <img src="assets/images/Easy-Notes-Logo.png" alt="Logo" style="width: 200px; height: 200px;">
        <div class="from-tech-art-container">
            <img src="assets/images/from-tech-art.png" alt="from Tech-Art" class="from-tech-art">
        </div>
    </div>
    <div id="notes-list">
        <h1>Easy Notes</h1>
        <input type="text" id="search-bar" placeholder="Search Notes">
        <ul id="notes"></ul>
        <button id="add-note-btn">+</button>
    </div>
    <div id="note-editor" style="display: none;">
        <input type="text" id="note-title" placeholder="Note Title">
        <textarea id="note-content"></textarea>
        <div id="editor-toolbar">
            <div>
                <label for="note-category">Category:</label>
                <select id="note-category">
                    <option value="work">Work</option>
                    <option value="personal">Personal</option>
                    <option value="learn">Learn</option>
                </select>
            </div>
            <div>
                <button type="button" onclick="document.getElementById('file-upload').click()">Upload Image</button>
                <input type="file" id="file-upload" accept="image/*" multiple>
                <div class="image-preview-container" id="image-preview-container"></div>
            </div>
            <div>
                <button onclick="document.execCommand('bold', false, '');">Bold</button>
                <button onclick="document.execCommand('italic', false, '');">Italic</button>
                <button onclick="document.execCommand('underline', false, '');">Underline</button>
                <button onclick="document.execCommand('justifyCenter', false, '');">Center</button>
                <input type="color" id="color-picker" value="#000000">
                <button onclick="changeTextColor();">Change Text Color</button>
            </div>
            <div>
                <button id="save-note-btn">Save</button>
                <button id="back-to-list-main">Back</button>
            </div>
        </div>
    </div>
    <div id="note-detail">
        <button id="back-to-list">返回</button>
        <h2 id="detail-title"></h2>
        <div id="detail-content"></div>
        <div id="detail-category"></div>
        <div class="image-preview-container" id="detail-image-container"></div>
        <div class="note-actions">
            <button id="edit-note-btn">Edit</button>
            <button id="delete-note-btn">Delete</button>
        </div>
    </div>
    <div id="delete-confirm">
        <p>Are you sure you want to delete this note?</p>
        <button id="confirm-delete-btn">Yes</button>
        <button class="cancel" id="cancel-delete-btn">No</button>
    </div>
    <script>
        let notes = [];
        let currentNoteIndex = -1;

        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById("loading-page").style.display = "none";
            document.getElementById("add-note-btn").addEventListener("click", showNoteEditor);
            document.getElementById("save-note-btn").addEventListener("click", saveNote);
            document.getElementById("back-to-list-main").addEventListener("click", showNotesList);
            document.getElementById("file-upload").addEventListener("change", handleFileSelect);
            document.getElementById("back-to-list").addEventListener("click", showNotesList);
            document.getElementById("search-bar").addEventListener("input", searchNotes);
            document.getElementById("edit-note-btn").addEventListener("click", editCurrentNote);
            document.getElementById("delete-note-btn").addEventListener("click", showDeleteConfirm);
            document.getElementById("confirm-delete-btn").addEventListener("click", deleteCurrentNote);
            document.getElementById("cancel-delete-btn").addEventListener("click", hideDeleteConfirm);
        });

        function handleFileSelect(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('image-preview-container');

            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const reader = new FileReader();

                reader.onload = function (e) {
                    const previewDiv = document.createElement('div');
                    previewDiv.className = 'image-preview';

                    const img = document.createElement('img');
                    img.src = e.target.result;
                    previewDiv.appendChild(img);

                    const deleteBtn = document.createElement('button');
                    deleteBtn.className = 'delete-image';
                    deleteBtn.innerHTML = 'X';
                    deleteBtn.onclick = function () {
                        previewContainer.removeChild(previewDiv);
                    };
                    previewDiv.appendChild(deleteBtn);

                    previewContainer.appendChild(previewDiv);
                };

                reader.readAsDataURL(file);
            }
        }

        function showNoteEditor() {
            document.getElementById("note-editor").style.display = "block";
            document.getElementById("notes-list").style.display = "none";
            document.getElementById("note-detail").style.display = "none";
            document.getElementById("note-title").value = "";
            document.getElementById("note-content").value = "";
            document.getElementById("note-category").value = "work";
            document.getElementById("image-preview-container").innerHTML = "";
            currentNoteIndex = -1;
        }

        function saveNote() {
            const title = document.getElementById("note-title").value;
            const content = document.getElementById("note-content").value;
            const category = document.getElementById("note-category").value;
            const images = Array.from(document.getElementById("image-preview-container").children).map(previewDiv => previewDiv.querySelector('img').src);

            if (currentNoteIndex === -1) {
                notes.push({ title, content, category, images });
            } else {
                notes[currentNoteIndex] = { title, content, category, images };
            }

            updateNotesList();
            showNotesList();
        }

        function showNotesList() {
            document.getElementById("note-editor").style.display = "none";
            document.getElementById("notes-list").style.display = "block";
            document.getElementById("note-detail").style.display = "none";
        }

        function updateNotesList() {
            const notesUl = document.getElementById("notes");
            notesUl.innerHTML = "";

            notes.forEach((note, index) => {
                const noteLi = document.createElement("li");
                noteLi.onclick = () => showNoteDetail(index);

                const title = document.createElement("div");
                title.textContent = note.title;
                noteLi.appendChild(title);

                const category = document.createElement("span");
                category.classList.add("category-tag", `category-${note.category}`);
                category.textContent = note.category.charAt(0).toUpperCase() + note.category.slice(1);
                noteLi.appendChild(category);

                const preview = document.createElement("div");
                preview.className = "note-preview";
                preview.textContent = note.content;
                noteLi.appendChild(preview);

                notesUl.appendChild(noteLi);
            });
        }

        function showNoteDetail(index) {
            const note = notes[index];
            currentNoteIndex = index;

            document.getElementById("detail-title").textContent = note.title;
            document.getElementById("detail-content").textContent = note.content;
            document.getElementById("detail-category").textContent = note.category;
            document.getElementById("detail-image-container").innerHTML = note.images.map(src => `<div class="image-preview"><img src="${src}" alt="Note Image"></div>`).join("");

            document.getElementById("note-editor").style.display = "none";
            document.getElementById("notes-list").style.display = "none";
            document.getElementById("note-detail").style.display = "block";
        }

        function editCurrentNote() {
            const note = notes[currentNoteIndex];

            document.getElementById("note-title").value = note.title;
            document.getElementById("note-content").value = note.content;
            document.getElementById("note-category").value = note.category;

            const previewContainer = document.getElementById("image-preview-container");
            previewContainer.innerHTML = "";

            note.images.forEach(src => {
                const previewDiv = document.createElement('div');
                previewDiv.className = 'image-preview';

                const img = document.createElement('img');
                img.src = src;
                previewDiv.appendChild(img);

                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'delete-image';
                deleteBtn.innerHTML = 'X';
                deleteBtn.onclick = function () {
                    previewContainer.removeChild(previewDiv);
                };
                previewDiv.appendChild(deleteBtn);

                previewContainer.appendChild(previewDiv);
            });

            showNoteEditor();
        }

        function showDeleteConfirm() {
            document.getElementById("delete-confirm").style.display = "block";
        }

        function hideDeleteConfirm() {
            document.getElementById("delete-confirm").style.display = "none";
        }

        function deleteCurrentNote() {
            if (currentNoteIndex > -1) {
                notes.splice(currentNoteIndex, 1);
                currentNoteIndex = -1;
                updateNotesList();
                showNotesList();
                hideDeleteConfirm();
            }
        }

        function searchNotes() {
            const query = document.getElementById("search-bar").value.toLowerCase();
            const notesUl = document.getElementById("notes");
            notesUl.innerHTML = "";

            notes.forEach((note, index) => {
                if (note.title.toLowerCase().includes(query) || note.content.toLowerCase().includes(query) || note.category.toLowerCase().includes(query)) {
                    const noteLi = document.createElement("li");
                    noteLi.onclick = () => showNoteDetail(index);

                    const title = document.createElement("div");
                    title.textContent = note.title;
                    noteLi.appendChild(title);

                    const category = document.createElement("span");
                    category.classList.add("category-tag", `category-${note.category}`);
                    category.textContent = note.category.charAt(0).toUpperCase() + note.category.slice(1);
                    noteLi.appendChild(category);

                    const preview = document.createElement("div");
                    preview.className = "note-preview";
                    preview.textContent = note.content;
                    noteLi.appendChild(preview);

                    notesUl.appendChild(noteLi);
                }
            });
        }

        function changeTextColor() {
            const color = document.getElementById('color-picker').value;
            document.execCommand('foreColor', false, color);
        }
    </script>
</body>
</html>
